{"ast":null,"code":"import _regeneratorRuntime from\"D:/Coding/My-Github/usePopCorn/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/Coding/My-Github/usePopCorn/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/Coding/My-Github/usePopCorn/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";var KEY=\"f84fc31d\";export function useMovies(query){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),movies=_useState2[0],setMovies=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];useEffect(function(){// callback?.();\nvar controller=new AbortController();function fetchMovies(){return _fetchMovies.apply(this,arguments);}function _fetchMovies(){_fetchMovies=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;setIsLoading(true);setError(\"\");_context.next=5;return fetch(\"http://www.omdbapi.com/?apikey=\".concat(KEY,\"&s=\").concat(query),{signal:controller.signal});case 5:res=_context.sent;if(res.ok){_context.next=8;break;}throw new Error(\"Something went wrong with fetching movies\");case 8:_context.next=10;return res.json();case 10:data=_context.sent;if(!(data.Response===\"False\")){_context.next=13;break;}throw new Error(\"Movie not found\");case 13:setMovies(data.Search);setError(\"\");_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](0);if(_context.t0.name!==\"AbortError\"){console.log(_context.t0.message);setError(_context.t0.message);}case 20:_context.prev=20;setIsLoading(false);return _context.finish(20);case 23:case\"end\":return _context.stop();}},_callee,null,[[0,17,20,23]]);}));return _fetchMovies.apply(this,arguments);}if(query.length<3){setMovies([]);setError(\"\");return;}fetchMovies();return function(){controller.abort();};},[query]);return{movies:movies,isLoading:isLoading,error:error};}","map":{"version":3,"names":["useState","useEffect","KEY","useMovies","query","_useState","_useState2","_slicedToArray","movies","setMovies","_useState3","_useState4","isLoading","setIsLoading","_useState5","_useState6","error","setError","controller","AbortController","fetchMovies","_fetchMovies","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","data","wrap","_callee$","_context","prev","next","fetch","concat","signal","sent","ok","Error","json","Response","Search","t0","name","console","log","message","finish","stop","length","abort"],"sources":["D:/Coding/My-Github/usePopCorn/src/useMovies.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\n\nconst KEY = \"f84fc31d\";\n\nexport function useMovies(query) {\n  const [movies, setMovies] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n\n  useEffect(\n    function () {\n      // callback?.();\n\n      const controller = new AbortController();\n\n      async function fetchMovies() {\n        try {\n          setIsLoading(true);\n          setError(\"\");\n\n          const res = await fetch(\n            `http://www.omdbapi.com/?apikey=${KEY}&s=${query}`,\n            { signal: controller.signal }\n          );\n\n          if (!res.ok)\n            throw new Error(\"Something went wrong with fetching movies\");\n\n          const data = await res.json();\n          if (data.Response === \"False\") throw new Error(\"Movie not found\");\n\n          setMovies(data.Search);\n          setError(\"\");\n        } catch (err) {\n          if (err.name !== \"AbortError\") {\n            console.log(err.message);\n            setError(err.message);\n          }\n        } finally {\n          setIsLoading(false);\n        }\n      }\n\n      if (query.length < 3) {\n        setMovies([]);\n        setError(\"\");\n        return;\n      }\n\n      fetchMovies();\n\n      return function () {\n        controller.abort();\n      };\n    },\n    [query]\n  );\n\n  return { movies, isLoading, error };\n}\n"],"mappings":"4WAAA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAE3C,GAAM,CAAAC,GAAG,CAAG,UAAU,CAEtB,MAAO,SAAS,CAAAC,SAASA,CAACC,KAAK,CAAE,CAC/B,IAAAC,SAAA,CAA4BL,QAAQ,CAAC,EAAE,CAAC,CAAAM,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAAjCG,MAAM,CAAAF,UAAA,IAAEG,SAAS,CAAAH,UAAA,IACxB,IAAAI,UAAA,CAAkCV,QAAQ,CAAC,KAAK,CAAC,CAAAW,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAA1CE,SAAS,CAAAD,UAAA,IAAEE,YAAY,CAAAF,UAAA,IAC9B,IAAAG,UAAA,CAA0Bd,QAAQ,CAAC,EAAE,CAAC,CAAAe,UAAA,CAAAR,cAAA,CAAAO,UAAA,IAA/BE,KAAK,CAAAD,UAAA,IAAEE,QAAQ,CAAAF,UAAA,IAEtBd,SAAS,CACP,UAAY,CACV;AAEA,GAAM,CAAAiB,UAAU,CAAG,GAAI,CAAAC,eAAe,EAAE,CAAC,QAE1B,CAAAC,WAAWA,CAAA,SAAAC,YAAA,CAAAC,KAAA,MAAAC,SAAA,YAAAF,aAAA,EAAAA,YAAA,CAAAG,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAA1B,SAAAC,QAAA,MAAAC,GAAA,CAAAC,IAAA,QAAAJ,mBAAA,GAAAK,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAAAF,QAAA,CAAAC,IAAA,GAEIpB,YAAY,CAAC,IAAI,CAAC,CAClBI,QAAQ,CAAC,EAAE,CAAC,CAACe,QAAA,CAAAE,IAAA,SAEK,CAAAC,KAAK,mCAAAC,MAAA,CACalC,GAAG,QAAAkC,MAAA,CAAMhC,KAAK,EAChD,CAAEiC,MAAM,CAAEnB,UAAU,CAACmB,MAAO,CAAC,CAC9B,QAHKT,GAAG,CAAAI,QAAA,CAAAM,IAAA,IAKJV,GAAG,CAACW,EAAE,EAAAP,QAAA,CAAAE,IAAA,eACH,IAAI,CAAAM,KAAK,CAAC,2CAA2C,CAAC,QAAAR,QAAA,CAAAE,IAAA,UAE3C,CAAAN,GAAG,CAACa,IAAI,EAAE,SAAvBZ,IAAI,CAAAG,QAAA,CAAAM,IAAA,MACNT,IAAI,CAACa,QAAQ,GAAK,OAAO,GAAAV,QAAA,CAAAE,IAAA,gBAAQ,IAAI,CAAAM,KAAK,CAAC,iBAAiB,CAAC,SAEjE/B,SAAS,CAACoB,IAAI,CAACc,MAAM,CAAC,CACtB1B,QAAQ,CAAC,EAAE,CAAC,CAACe,QAAA,CAAAE,IAAA,kBAAAF,QAAA,CAAAC,IAAA,IAAAD,QAAA,CAAAY,EAAA,CAAAZ,QAAA,aAEb,GAAIA,QAAA,CAAAY,EAAA,CAAIC,IAAI,GAAK,YAAY,CAAE,CAC7BC,OAAO,CAACC,GAAG,CAACf,QAAA,CAAAY,EAAA,CAAII,OAAO,CAAC,CACxB/B,QAAQ,CAACe,QAAA,CAAAY,EAAA,CAAII,OAAO,CAAC,CACvB,CAAC,QAAAhB,QAAA,CAAAC,IAAA,IAEDpB,YAAY,CAAC,KAAK,CAAC,CAAC,OAAAmB,QAAA,CAAAiB,MAAA,8BAAAjB,QAAA,CAAAkB,IAAA,MAAAvB,OAAA,uBAEvB,UAAAN,YAAA,CAAAC,KAAA,MAAAC,SAAA,GAED,GAAInB,KAAK,CAAC+C,MAAM,CAAG,CAAC,CAAE,CACpB1C,SAAS,CAAC,EAAE,CAAC,CACbQ,QAAQ,CAAC,EAAE,CAAC,CACZ,OACF,CAEAG,WAAW,EAAE,CAEb,MAAO,WAAY,CACjBF,UAAU,CAACkC,KAAK,EAAE,CACpB,CAAC,CACH,CAAC,CACD,CAAChD,KAAK,CAAC,CACR,CAED,MAAO,CAAEI,MAAM,CAANA,MAAM,CAAEI,SAAS,CAATA,SAAS,CAAEI,KAAK,CAALA,KAAM,CAAC,CACrC"},"metadata":{},"sourceType":"module","externalDependencies":[]}